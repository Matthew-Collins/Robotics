' Gambas class file

Public Pin As Integer
Public Frequency As Integer
Public Value As Integer
Public Timer As New Timer
Public IsOn As Boolean

Sub Start(Value As Integer) 
  Timer.Delay = Me.Frequency
  ison = True
  ChangeDutyCycle(value)
  Timer.Start
End Sub
Sub ChangeDutyCycle(Value As Integer)
  Me.Value = Value
  Exec "GPIO -g PWM " & Pin & " " & Value
End
Sub ChangeFrequency(Frequency As Integer)
 Me.Timer.Delay = Frequency
End 
Public Sub Timer_Timer()
 If Me.IsOn Then
    Me.IsOn = False
    ChangeDutyCycle(0)
 Else
    Me.IsOn = True
    ChangeDutyCycle(Me.Value)
 End If
End Sub

